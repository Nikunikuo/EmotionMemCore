"""
EmotionMemCore åˆå¿ƒè€…å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šç¾©
YouTubeè¦‹ã‚‹ã ã‘å±¤ã§ã‚‚åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
"""

from typing import Dict, Any

class UserFriendlyMessages:
    """åˆå¿ƒè€…å‘ã‘ã®åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"""
    
    # ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•é–¢é€£
    STARTUP_MESSAGES = {
        "starting": "ğŸš€ EmotionMemCore ã‚’èµ·å‹•ã—ã¦ã„ã¾ã™...",
        "started": "âœ¨ èµ·å‹•å®Œäº†ï¼ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„",
        "failed": "âŒ èµ·å‹•ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã‚’ãŠè©¦ã—ãã ã•ã„ï¼š\n1. ä»–ã®ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã¦ãã ã•ã„\n2. ãƒ‘ã‚½ã‚³ãƒ³ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„\n3. ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„"
    }
    
    # APIé–¢é€£ã‚¨ãƒ©ãƒ¼
    API_ERRORS = {
        "connection_failed": {
            "title": "ğŸ”Œ æ¥ç¶šã‚¨ãƒ©ãƒ¼",
            "message": "APIã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“",
            "solutions": [
                "ãƒ¡ã‚¤ãƒ³APIã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "ã€Œstart_emotionmemcore.batã€ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§èµ·å‹•ã—ã¦ãã ã•ã„",
                "ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "ãƒãƒ¼ãƒˆ8000, 8080ãŒä»–ã®ã‚¢ãƒ—ãƒªã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„"
            ]
        },
        "api_key_missing": {
            "title": "ğŸ”‘ APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“",
            "message": "æœ¬æ ¼çš„ãªæ©Ÿèƒ½ã‚’ä½¿ã†ã«ã¯APIã‚­ãƒ¼ãŒå¿…è¦ã§ã™",
            "solutions": [
                "ä»Šã™ãè©¦ã—ãŸã„å ´åˆï¼šã€Œè¨­å®šã€â†’ã€Œãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã€ã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„",
                "æœ¬æ ¼åˆ©ç”¨ã®å ´åˆï¼šOpenAIã®APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ãã ã•ã„",
                "è©³ç´°ã¯ã€Œè¨­å®šã‚¬ã‚¤ãƒ‰ã€ã‚’ã”è¦§ãã ã•ã„"
            ]
        },
        "rate_limit": {
            "title": "â° ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™",
            "message": "çŸ­æ™‚é–“ã§å¤šãã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸ",
            "solutions": [
                "1åˆ†ã»ã©ãŠå¾…ã¡ãã ã•ã„",
                "è‡ªå‹•åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä¸€æ™‚åœæ­¢ã—ã¦ãã ã•ã„",
                "è¨­å®šã§åˆ¶é™ã‚’ç·©å’Œã§ãã¾ã™ï¼ˆä¸Šç´šè€…å‘ã‘ï¼‰"
            ]
        }
    }
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ã‚¨ãƒ©ãƒ¼
    DATABASE_ERRORS = {
        "save_failed": {
            "title": "ğŸ’¾ ä¿å­˜ã‚¨ãƒ©ãƒ¼",
            "message": "è¨˜æ†¶ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ",
            "solutions": [
                "ãƒ‡ã‚£ã‚¹ã‚¯ã®ç©ºãå®¹é‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "ã‚¢ãƒ³ãƒã‚¦ã‚¤ãƒ«ã‚¹ã‚½ãƒ•ãƒˆã§ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "ãƒ•ã‚©ãƒ«ãƒ€ã®æ¨©é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "ãƒ‘ã‚½ã‚³ãƒ³ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„"
            ]
        },
        "search_failed": {
            "title": "ğŸ” æ¤œç´¢ã‚¨ãƒ©ãƒ¼",
            "message": "è¨˜æ†¶ã®æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸ",
            "solutions": [
                "ä¿å­˜ã•ã‚ŒãŸè¨˜æ†¶ãŒã‚ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„",
                "ã€Œæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã€ã§ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¦ãã ã•ã„"
            ]
        }
    }
    
    # LLMé–¢é€£ã‚¨ãƒ©ãƒ¼
    LLM_ERRORS = {
        "claude_error": {
            "title": "ğŸ¤– Claude AI ã‚¨ãƒ©ãƒ¼",
            "message": "Claude AIã¨ã®é€šä¿¡ã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ",
            "solutions": [
                "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "Claude APIã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "å°‘ã—æ™‚é–“ã‚’ç½®ã„ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„",
                "ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œç¢ºèªã—ã¦ãã ã•ã„"
            ]
        },
        "openai_error": {
            "title": "ğŸ§  OpenAI ã‚¨ãƒ©ãƒ¼",
            "message": "OpenAI ã¨ã®é€šä¿¡ã§å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ",
            "solutions": [
                "ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "OpenAI APIã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "APIã‚­ãƒ¼ã®æ®‹é«˜ã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "å°‘ã—æ™‚é–“ã‚’ç½®ã„ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„"
            ]
        }
    }
    
    # æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    SUCCESS_MESSAGES = {
        "memory_saved": "âœ… è¨˜æ†¶ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼æ„Ÿæƒ…åˆ†æã‚‚å®Œäº†ã§ã™",
        "memory_searched": "ğŸ” è¨˜æ†¶ã‚’æ¤œç´¢ã—ã¾ã—ãŸï¼é–¢é€£ã™ã‚‹è¨˜æ†¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ",
        "test_completed": "ğŸ‰ ãƒ†ã‚¹ãƒˆãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼",
        "settings_saved": "âš™ï¸ è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚å†èµ·å‹•å¾Œã«æœ‰åŠ¹ã«ãªã‚Šã¾ã™"
    }
    
    # åˆå¿ƒè€…å‘ã‘ãƒ’ãƒ³ãƒˆ
    BEGINNER_TIPS = {
        "first_visit": {
            "title": "ğŸ‰ EmotionMemCore ã¸ã‚ˆã†ã“ãï¼",
            "message": "åˆã‚ã¦ã”åˆ©ç”¨ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™",
            "tips": [
                "ã¾ãšã¯ã€Œæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã€ã§ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½“é¨“ã—ã¦ã¿ã¦ãã ã•ã„",
                "ã€Œè¨˜æ†¶æ¤œç´¢ã€ã§è‡ªç„¶ãªæ—¥æœ¬èªã§æ¤œç´¢ã§ãã¾ã™",
                "ã€Œè¨˜æ†¶å¯è¦–åŒ–ã€ã§ç¾ã—ã„ã‚°ãƒ©ãƒ•ã‚’æ¥½ã—ã‚ã¾ã™",
                "å›°ã£ãŸã¨ãã¯ã€Œè¨­å®šã‚¬ã‚¤ãƒ‰ã€ã‚’ã”è¦§ãã ã•ã„"
            ]
        },
        "no_memories": {
            "title": "ğŸ’­ è¨˜æ†¶ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“",
            "message": "è¨˜æ†¶ã‚’ä½œæˆã—ã¦ EmotionMemCore ã‚’ä½“é¨“ã—ã¾ã—ã‚‡ã†",
            "tips": [
                "ã€Œæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã€ã§ã‚µãƒ³ãƒ—ãƒ«è¨˜æ†¶ã‚’ä½œæˆã§ãã¾ã™",
                "ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã¨ã€ŒAIãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’å…¥åŠ›ã—ã¦ä¿å­˜ã—ã¦ã¿ã¦ãã ã•ã„",
                "è‡ªå‹•ã§æ„Ÿæƒ…åˆ†æãŒè¡Œã‚ã‚Œã€å¾Œã§æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™"
            ]
        }
    }
    
    # ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
    TROUBLESHOOTING = {
        "common_issues": {
            "browser_not_opening": {
                "problem": "ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•ã§é–‹ã‹ãªã„",
                "solution": "æ‰‹å‹•ã§ http://localhost:8080 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„"
            },
            "slow_performance": {
                "problem": "å‹•ä½œãŒé‡ã„ãƒ»é…ã„",
                "solution": "ä»–ã®ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚‹ã‹ã€ãƒ‘ã‚½ã‚³ãƒ³ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„"
            },
            "windows_defender": {
                "problem": "Windows Defenderã§è­¦å‘ŠãŒå‡ºã‚‹",
                "solution": "ã€Œè©³ç´°æƒ…å ±ã€â†’ã€Œå®Ÿè¡Œã€ã§èµ·å‹•ã§ãã¾ã™ï¼ˆå®‰å…¨ãªã‚½ãƒ•ãƒˆã§ã™ï¼‰"
            },
            "port_occupied": {
                "problem": "ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã®ã‚¨ãƒ©ãƒ¼",
                "solution": "ä»–ã®ã‚¢ãƒ—ãƒªã‚’çµ‚äº†ã™ã‚‹ã‹ã€ãƒ‘ã‚½ã‚³ãƒ³ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„"
            }
        }
    }

    @staticmethod
    def get_error_message(error_type: str, error_key: str) -> Dict[str, Any]:
        """ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã¨ã‚­ãƒ¼ã‹ã‚‰åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—"""
        error_messages = {
            "api": UserFriendlyMessages.API_ERRORS,
            "database": UserFriendlyMessages.DATABASE_ERRORS,
            "llm": UserFriendlyMessages.LLM_ERRORS
        }
        
        if error_type in error_messages and error_key in error_messages[error_type]:
            return error_messages[error_type][error_key]
        
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        return {
            "title": "â“ ä¸æ˜ãªã‚¨ãƒ©ãƒ¼",
            "message": "äºˆæœŸã—ãªã„å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ",
            "solutions": [
                "ç”»é¢ã‚’æ›´æ–°ã—ã¦ãã ã•ã„ï¼ˆF5ã‚­ãƒ¼ï¼‰",
                "ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„",
                "ãƒ‘ã‚½ã‚³ãƒ³ã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„",
                "å•é¡ŒãŒç¶šãå ´åˆã¯GitHubã§ã”å ±å‘Šãã ã•ã„"
            ]
        }
    
    @staticmethod
    def format_error_for_display(error_dict: Dict[str, Any]) -> str:
        """ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’è¡¨ç¤ºç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ"""
        title = error_dict.get("title", "ã‚¨ãƒ©ãƒ¼")
        message = error_dict.get("message", "å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ")
        solutions = error_dict.get("solutions", [])
        
        formatted = f"{title}\n\n{message}\n\n"
        
        if solutions:
            formatted += "ğŸ’¡ è§£æ±ºæ–¹æ³•:\n"
            for i, solution in enumerate(solutions, 1):
                formatted += f"{i}. {solution}\n"
        
        return formatted

# ä¾¿åˆ©é–¢æ•°
def get_user_friendly_error(error_type: str, error_key: str) -> str:
    """åˆå¿ƒè€…å‘ã‘ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—"""
    error_dict = UserFriendlyMessages.get_error_message(error_type, error_key)
    return UserFriendlyMessages.format_error_for_display(error_dict)

def get_success_message(key: str) -> str:
    """æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—"""
    return UserFriendlyMessages.SUCCESS_MESSAGES.get(key, "âœ… æ“ä½œãŒå®Œäº†ã—ã¾ã—ãŸ")

def get_beginner_tip(key: str) -> Dict[str, Any]:
    """åˆå¿ƒè€…å‘ã‘ãƒ’ãƒ³ãƒˆã‚’å–å¾—"""
    return UserFriendlyMessages.BEGINNER_TIPS.get(key, {
        "title": "ğŸ’¡ ãƒ’ãƒ³ãƒˆ",
        "message": "ä¸æ˜ãªç‚¹ãŒã‚ã‚Œã°è¨­å®šã‚¬ã‚¤ãƒ‰ã‚’ã”è¦§ãã ã•ã„",
        "tips": []
    })