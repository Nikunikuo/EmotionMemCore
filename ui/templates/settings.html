{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="bi bi-sliders text-primary"></i>
            è¨­å®šã‚¬ã‚¤ãƒ‰
        </h2>
        <p class="lead text-muted">
            EmotionMemCoreã®è¨­å®šã‚’åˆ†ã‹ã‚Šã‚„ã™ãã‚¬ã‚¤ãƒ‰ã—ã¾ã™ã€‚åˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒã—ã¦è¨­å®šã§ãã¾ã™ã€‚
        </p>
    </div>
</div>

<!-- è¨­å®šã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ -->
<div class="row mb-4">
    <div class="col-12">
        <div class="stats-card">
            <h4 class="mb-3">
                <i class="bi bi-list-check text-success"></i>
                è¨­å®šå®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
            </h4>
            <div class="progress-container">
                <div class="progress mb-3">
                    <div class="progress-bar bg-success" id="overallProgress" style="width: 60%"></div>
                </div>
                <div class="text-center">
                    <small class="text-muted">è¨­å®šå®Œäº†ç‡: <span id="progressText">60%</span></small>
                </div>
            </div>
            
            <div class="checklist">
                <div class="checklist-item completed" id="step1">
                    <i class="bi bi-check-circle-fill text-success"></i>
                    <div class="checklist-content">
                        <h6>âœ… åŸºæœ¬ç’°å¢ƒè¨­å®š</h6>
                        <p>Pythonç’°å¢ƒã¨EmotionMemCoreã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
                    </div>
                </div>
                
                <div class="checklist-item completed" id="step2">
                    <i class="bi bi-check-circle-fill text-success"></i>
                    <div class="checklist-content">
                        <h6>âœ… é–‹ç™ºãƒ¢ãƒ¼ãƒ‰èµ·å‹•</h6>
                        <p>ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã®åŸºæœ¬å‹•ä½œç¢ºèª</p>
                    </div>
                </div>
                
                <div class="checklist-item pending" id="step3">
                    <i class="bi bi-circle text-warning"></i>
                    <div class="checklist-content">
                        <h6>â³ APIã‚­ãƒ¼è¨­å®š</h6>
                        <p>OpenAIãƒ»Claude APIã‚­ãƒ¼ã®è¨­å®šï¼ˆæœ¬æ ¼é‹ç”¨æ™‚ï¼‰</p>
                        <button class="btn btn-sm btn-primary" onclick="showApiKeyGuide()">è¨­å®šã‚¬ã‚¤ãƒ‰</button>
                    </div>
                </div>
                
                <div class="checklist-item pending" id="step4">
                    <i class="bi bi-circle text-warning"></i>
                    <div class="checklist-content">
                        <h6>â³ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š</h6>
                        <p>èªè¨¼ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è¨­å®š</p>
                        <button class="btn btn-sm btn-primary" onclick="showSecurityGuide()">è¨­å®šã‚¬ã‚¤ãƒ‰</button>
                    </div>
                </div>
                
                <div class="checklist-item pending" id="step5">
                    <i class="bi bi-circle text-muted"></i>
                    <div class="checklist-content">
                        <h6>ğŸ“¦ æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤</h6>
                        <p>Dockerãƒ»æœ¬ç•ªç’°å¢ƒã¸ã®å±•é–‹</p>
                        <button class="btn btn-sm btn-outline-primary" onclick="showDeployGuide()">ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ç¾åœ¨ã®è¨­å®šè¡¨ç¤º -->
<div class="row mb-4">
    <div class="col-lg-6 mb-4">
        <div class="stats-card">
            <h5 class="mb-3">
                <i class="bi bi-gear text-info"></i>
                ç¾åœ¨ã®è¨­å®š
            </h5>
            <div class="settings-display">
                <div class="setting-item">
                    <div class="setting-label">ç’°å¢ƒãƒ¢ãƒ¼ãƒ‰</div>
                    <div class="setting-value">
                        <span class="badge bg-info">{{ current_settings.environment }}</span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰</div>
                    <div class="setting-value">
                        <span class="badge {% if current_settings.debug_mode == 'true' %}bg-warning{% else %}bg-secondary{% endif %}">
                            {{ current_settings.debug_mode }}
                        </span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">LLMãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰</div>
                    <div class="setting-value">
                        <span class="badge {% if current_settings.llm_mock_mode == 'true' %}bg-success{% else %}bg-danger{% endif %}">
                            {{ current_settings.llm_mock_mode }}
                        </span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">èªè¨¼æœ‰åŠ¹</div>
                    <div class="setting-value">
                        <span class="badge {% if current_settings.auth_enabled == 'true' %}bg-success{% else %}bg-warning{% endif %}">
                            {{ current_settings.auth_enabled }}
                        </span>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-label">ãƒ¬ãƒ¼ãƒˆåˆ¶é™</div>
                    <div class="setting-value">
                        <span class="badge {% if current_settings.rate_limit_enabled == 'true' %}bg-success{% else %}bg-warning{% endif %}">
                            {{ current_settings.rate_limit_enabled }}
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6 mb-4">
        <div class="stats-card">
            <h5 class="mb-3">
                <i class="bi bi-speedometer2 text-success"></i>
                ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹
            </h5>
            <div id="systemStatus">
                <div class="status-item">
                    <div class="status-indicator status-healthy"></div>
                    <div class="status-content">
                        <div class="status-title">ãƒ¡ã‚¤ãƒ³API</div>
                        <div class="status-desc" id="apiStatus">æ¥ç¶šãƒã‚§ãƒƒã‚¯ä¸­...</div>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-indicator status-healthy"></div>
                    <div class="status-content">
                        <div class="status-title">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
                        <div class="status-desc">æ­£å¸¸ç¨¼åƒä¸­</div>
                    </div>
                </div>
                
                <div class="status-item">
                    <div class="status-indicator status-warning"></div>
                    <div class="status-content">
                        <div class="status-title">æœ¬ç•ªæº–å‚™åº¦</div>
                        <div class="status-desc">60% - é–‹ç™ºæ®µéš</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- è¨­å®šå¤‰æ›´ãƒ•ã‚©ãƒ¼ãƒ  -->
<div class="row mb-4">
    <div class="col-12">
        <div class="stats-card">
            <h5 class="mb-3">
                <i class="bi bi-wrench text-warning"></i>
                è¨­å®šå¤‰æ›´
            </h5>
            <p class="text-muted mb-4">
                âš ï¸ è¨­å®šå¤‰æ›´å¾Œã¯ã€ãƒ¡ã‚¤ãƒ³APIã‚µãƒ¼ãƒãƒ¼ã¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®å†èµ·å‹•ãŒå¿…è¦ã§ã™ã€‚
            </p>
            
            <form id="settingsForm">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="environmentSelect" class="form-label">
                            <i class="bi bi-globe"></i>
                            ç’°å¢ƒãƒ¢ãƒ¼ãƒ‰
                        </label>
                        <select class="form-select" id="environmentSelect" name="environment">
                            <option value="development" {% if current_settings.environment == 'development' %}selected{% endif %}>
                                é–‹ç™ºç’°å¢ƒ (development)
                            </option>
                            <option value="staging" {% if current_settings.environment == 'staging' %}selected{% endif %}>
                                ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ (staging)
                            </option>
                            <option value="production" {% if current_settings.environment == 'production' %}selected{% endif %}>
                                æœ¬ç•ªç’°å¢ƒ (production)
                            </option>
                        </select>
                        <div class="form-text">é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæ®µéšã§ã¯ "development" ã‚’æ¨å¥¨</div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="debugModeSelect" class="form-label">
                            <i class="bi bi-bug"></i>
                            ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
                        </label>
                        <select class="form-select" id="debugModeSelect" name="debug_mode">
                            <option value="true" {% if current_settings.debug_mode == 'true' %}selected{% endif %}>
                                æœ‰åŠ¹ (è©³ç´°ãƒ­ã‚°å‡ºåŠ›)
                            </option>
                            <option value="false" {% if current_settings.debug_mode == 'false' %}selected{% endif %}>
                                ç„¡åŠ¹ (é€šå¸¸ãƒ­ã‚°)
                            </option>
                        </select>
                        <div class="form-text">å•é¡Œè§£æ±ºæ™‚ã¯æœ‰åŠ¹ã«ã™ã‚‹ã¨è©³ç´°æƒ…å ±ãŒå–å¾—ã§ãã¾ã™</div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="mockModeSelect" class="form-label">
                            <i class="bi bi-robot"></i>
                            LLMãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰
                        </label>
                        <select class="form-select" id="mockModeSelect" name="llm_mock_mode">
                            <option value="true" {% if current_settings.llm_mock_mode == 'true' %}selected{% endif %}>
                                æœ‰åŠ¹ (APIã‚­ãƒ¼ä¸è¦)
                            </option>
                            <option value="false" {% if current_settings.llm_mock_mode == 'false' %}selected{% endif %}>
                                ç„¡åŠ¹ (å®Ÿéš›ã®APIä½¿ç”¨)
                            </option>
                        </select>
                        <div class="form-text">åˆæœŸãƒ†ã‚¹ãƒˆã§ã¯ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’æ¨å¥¨</div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="authSelect" class="form-label">
                            <i class="bi bi-shield-check"></i>
                            èªè¨¼æ©Ÿèƒ½
                        </label>
                        <select class="form-select" id="authSelect" name="auth_enabled">
                            <option value="false" {% if current_settings.auth_enabled == 'false' %}selected{% endif %}>
                                ç„¡åŠ¹ (é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨)
                            </option>
                            <option value="true" {% if current_settings.auth_enabled == 'true' %}selected{% endif %}>
                                æœ‰åŠ¹ (æœ¬ç•ªé‹ç”¨)
                            </option>
                        </select>
                        <div class="form-text">æœ¬ç•ªé‹ç”¨æ™‚ã¯å¿…ãšæœ‰åŠ¹ã«ã—ã¦ãã ã•ã„</div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="rateLimitSelect" class="form-label">
                            <i class="bi bi-speedometer"></i>
                            ãƒ¬ãƒ¼ãƒˆåˆ¶é™
                        </label>
                        <select class="form-select" id="rateLimitSelect" name="rate_limit_enabled">
                            <option value="false" {% if current_settings.rate_limit_enabled == 'false' %}selected{% endif %}>
                                ç„¡åŠ¹ (é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨)
                            </option>
                            <option value="true" {% if current_settings.rate_limit_enabled == 'true' %}selected{% endif %}>
                                æœ‰åŠ¹ (DoSæ”»æ’ƒå¯¾ç­–)
                            </option>
                        </select>
                        <div class="form-text">æœ¬ç•ªé‹ç”¨æ™‚ã¯å¿…ãšæœ‰åŠ¹ã«ã—ã¦ãã ã•ã„</div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label for="logLevelSelect" class="form-label">
                            <i class="bi bi-journal-text"></i>
                            ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
                        </label>
                        <select class="form-select" id="logLevelSelect" name="log_level">
                            <option value="DEBUG">DEBUG (å…¨ã¦ã®ãƒ­ã‚°)</option>
                            <option value="INFO" selected>INFO (é€šå¸¸æƒ…å ±)</option>
                            <option value="WARNING">WARNING (è­¦å‘Šä»¥ä¸Š)</option>
                            <option value="ERROR">ERROR (ã‚¨ãƒ©ãƒ¼ã®ã¿)</option>
                        </select>
                        <div class="form-text">é–‹ç™ºæ™‚ã¯INFOã€å•é¡Œç™ºç”Ÿæ™‚ã¯DEBUGã‚’æ¨å¥¨</div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <button type="submit" class="btn btn-success">
                        <i class="bi bi-check-lg"></i>
                        è¨­å®šã‚’ä¿å­˜
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="resetToDefaults()">
                        <i class="bi bi-arrow-clockwise"></i>
                        ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
                    </button>
                    <button type="button" class="btn btn-info" onclick="exportSettings()">
                        <i class="bi bi-download"></i>
                        è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="row">
    <div class="col-lg-4 col-md-6 mb-3">
        <div class="quick-action-card">
            <div class="icon text-primary">
                <i class="bi bi-play-circle"></i>
            </div>
            <h5>å³åº§ã«è©¦ã™</h5>
            <p>è¨­å®šå¤‰æ›´ãªã—ã§ä»Šã™ã EmotionMemCore ã‚’ä½“é¨“</p>
            <a href="/test" class="btn btn-primary">æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã¸</a>
        </div>
    </div>
    
    <div class="col-lg-4 col-md-6 mb-3">
        <div class="quick-action-card">
            <div class="icon text-success">
                <i class="bi bi-book"></i>
            </div>
            <h5>è©³ç´°ã‚¬ã‚¤ãƒ‰</h5>
            <p>ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°è¨­å®šã‚¬ã‚¤ãƒ‰</p>
            <button class="btn btn-success" onclick="showDetailedGuide()">ã‚¬ã‚¤ãƒ‰ã‚’é–‹ã</button>
        </div>
    </div>
    
    <div class="col-lg-4 col-md-6 mb-3">
        <div class="quick-action-card">
            <div class="icon text-warning">
                <i class="bi bi-question-circle"></i>
            </div>
            <h5>ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒˆ</h5>
            <p>å•é¡ŒãŒç™ºç”Ÿã—ãŸæ™‚ã®è§£æ±ºæ–¹æ³•</p>
            <button class="btn btn-warning" onclick="showTroubleshooting()">å•é¡Œè§£æ±ºã‚¬ã‚¤ãƒ‰</button>
        </div>
    </div>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ«: APIã‚­ãƒ¼è¨­å®šã‚¬ã‚¤ãƒ‰ -->
<div class="modal fade" id="apiKeyModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-key"></i>
                    APIã‚­ãƒ¼è¨­å®šã‚¬ã‚¤ãƒ‰
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <h6>ğŸ”‘ å¿…è¦ãªAPIã‚­ãƒ¼</h6>
                    <div class="alert alert-info">
                        <strong>é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæ®µéšã§ã¯è¨­å®šä¸è¦ã§ã™ï¼</strong><br>
                        ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§å…¨æ©Ÿèƒ½ã‚’ãŠè©¦ã—ã„ãŸã ã‘ã¾ã™ã€‚
                    </div>
                    
                    <div class="api-key-section">
                        <h6>1. OpenAI API ã‚­ãƒ¼ï¼ˆå¿…é ˆï¼‰</h6>
                        <p>è¨˜æ†¶ã®ãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼ˆEmbeddingï¼‰ã«ä½¿ç”¨ã—ã¾ã™ã€‚</p>
                        <ul>
                            <li><a href="https://platform.openai.com/api-keys" target="_blank">OpenAI API Keys</a> ã§å–å¾—</li>
                            <li>æœˆé¡ç´„$1-5ç¨‹åº¦ã®åˆ©ç”¨æ–™é‡‘</li>
                            <li>text-embedding-3-small ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨</li>
                        </ul>
                        
                        <h6 class="mt-3">2. Anthropic API ã‚­ãƒ¼ï¼ˆæ¨å¥¨ï¼‰</h6>
                        <p>Claude ã«ã‚ˆã‚‹è¨˜æ†¶ã®è¦ç´„ãƒ»æ„Ÿæƒ…åˆ†æã«ä½¿ç”¨ã—ã¾ã™ã€‚</p>
                        <ul>
                            <li><a href="https://console.anthropic.com/" target="_blank">Anthropic Console</a> ã§å–å¾—</li>
                            <li>Claude 3 Haiku ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ï¼ˆé«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆï¼‰</li>
                            <li>GPTä»£æ›¿ã‚‚å¯èƒ½ï¼ˆè¨­å®šã§åˆ‡ã‚Šæ›¿ãˆï¼‰</li>
                        </ul>
                    </div>
                    
                    <h6>ğŸ“ è¨­å®šæ–¹æ³•</h6>
                    <div class="code-block">
                        <pre><code># .env ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
OPENAI_API_KEY=sk-your-openai-api-key
ANTHROPIC_API_KEY=sk-ant-api-your-claude-key

# ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹åŒ–
LLM_MOCK_MODE=false</code></pre>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="markStepCompleted('step3')">
                    è¨­å®šå®Œäº†
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    å¾Œã§è¨­å®š
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ«: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚¬ã‚¤ãƒ‰ -->
<div class="modal fade" id="securityModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-shield-check"></i>
                    ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚¬ã‚¤ãƒ‰
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-4">
                    <div class="alert alert-warning">
                        <strong>æœ¬ç•ªé‹ç”¨æ™‚ã®ã¿å¿…è¦ã§ã™ï¼</strong><br>
                        é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆæ®µéšã§ã¯è¨­å®šä¸è¦ã§ã™ã€‚
                    </div>
                    
                    <h6>ğŸ›¡ï¸ å¿…é ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š</h6>
                    
                    <div class="security-section">
                        <h6>1. APIèªè¨¼ã®æœ‰åŠ¹åŒ–</h6>
                        <div class="code-block">
                            <pre><code># .env ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
AUTH_ENABLED=true
MASTER_API_KEY=your-secure-master-key-here</code></pre>
                        </div>
                        <p>å¼·åŠ›ãªãƒã‚¹ã‚¿ãƒ¼APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼ˆ32æ–‡å­—ä»¥ä¸Šæ¨å¥¨ï¼‰</p>
                        
                        <h6 class="mt-3">2. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®è¨­å®š</h6>
                        <div class="code-block">
                            <pre><code># DoSæ”»æ’ƒå¯¾ç­–
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPM=60    # åˆ†é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
RATE_LIMIT_RPH=1000  # æ™‚é–“ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°</code></pre>
                        </div>
                        
                        <h6 class="mt-3">3. CORSè¨­å®š</h6>
                        <div class="code-block">
                            <pre><code># è¨±å¯ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æŒ‡å®š
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com</code></pre>
                        </div>
                        
                        <h6 class="mt-3">4. HTTPSåŒ–</h6>
                        <p>æœ¬ç•ªç’°å¢ƒã§ã¯å¿…ãšHTTPSé€šä¿¡ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</p>
                        <ul>
                            <li>Let's Encryptç­‰ã§SSLè¨¼æ˜æ›¸ã‚’å–å¾—</li>
                            <li>ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ï¼ˆnginxï¼‰ã§HTTPSçµ‚ç«¯</li>
                            <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="markStepCompleted('step4')">
                    è¨­å®šå®Œäº†
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    å¾Œã§è¨­å®š
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ«: ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰ -->
<div class="modal fade" id="deployModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-rocket"></i>
                    æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="deploy-guide">
                    <h6>ğŸš€ æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤</h6>
                    
                    <div class="step-by-step">
                        <div class="deploy-step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h6>ç’°å¢ƒå¤‰æ•°ã®æº–å‚™</h6>
                                <div class="code-block">
                                    <pre><code># production.env ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
ENVIRONMENT=production
DEBUG_MODE=false
LLM_MOCK_MODE=false

# APIã‚­ãƒ¼è¨­å®š
OPENAI_API_KEY=sk-your-openai-key
ANTHROPIC_API_KEY=sk-ant-your-claude-key

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
AUTH_ENABLED=true
MASTER_API_KEY=your-super-secure-master-key
RATE_LIMIT_ENABLED=true

# CORSè¨­å®š
CORS_ALLOWED_ORIGINS=https://yourdomain.com</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h6>Dockerãƒ‡ãƒ—ãƒ­ã‚¤</h6>
                                <div class="code-block">
                                    <pre><code># æœ¬ç•ªç”¨Dockerèµ·å‹•
docker-compose -f docker-compose.yml --env-file production.env up -d

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl https://yourdomain.com/health/</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h6>ç›£è¦–ãƒ»ãƒ­ã‚°è¨­å®š</h6>
                                <div class="code-block">
                                    <pre><code># ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
sudo logrotate -d /etc/logrotate.d/emotionmemcore

# ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–
docker stats</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="deploy-step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h6>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š</h6>
                                <div class="code-block">
                                    <pre><code># æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆcrontabï¼‰
0 2 * * * curl -X POST https://yourdomain.com/debug/backup/emotion_memories</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-success mt-4">
                        <h6>âœ… ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã®ç¢ºèªé …ç›®</h6>
                        <ul class="mb-0">
                            <li>APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‹•ä½œç¢ºèª</li>
                            <li>èªè¨¼æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª</li>
                            <li>ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å‹•ä½œç¢ºèª</li>
                            <li>ãƒ­ã‚°å‡ºåŠ›ã®ç¢ºèª</li>
                            <li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã®ç¢ºèª</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="markStepCompleted('step5')">
                    ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    é–‰ã˜ã‚‹
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    .progress-container {
        margin-bottom: 2rem;
    }
    
    .checklist {
        list-style: none;
        padding: 0;
    }
    
    .checklist-item {
        display: flex;
        align-items: flex-start;
        padding: 1rem;
        margin-bottom: 0.5rem;
        border-radius: 0.75rem;
        transition: all 0.3s ease;
        border-left: 4px solid transparent;
    }
    
    .checklist-item.completed {
        background: linear-gradient(135deg, #e8f5e8, #f0f8f0);
        border-left-color: #28a745;
    }
    
    .checklist-item.pending {
        background: linear-gradient(135deg, #fff3cd, #fefefe);
        border-left-color: #ffc107;
    }
    
    .checklist-item i {
        font-size: 1.5rem;
        margin-right: 1rem;
        margin-top: 0.25rem;
    }
    
    .checklist-content {
        flex: 1;
    }
    
    .checklist-content h6 {
        margin-bottom: 0.5rem;
        font-weight: 600;
    }
    
    .checklist-content p {
        margin-bottom: 0.5rem;
        color: #666;
    }
    
    .settings-display {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    
    .setting-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem;
        background: #f8f9fa;
        border-radius: 0.5rem;
        border-left: 3px solid #007bff;
    }
    
    .setting-label {
        font-weight: 500;
        color: #333;
    }
    
    .setting-value .badge {
        font-size: 0.8rem;
    }
    
    .status-item {
        display: flex;
        align-items: center;
        padding: 0.75rem 0;
        border-bottom: 1px solid #eee;
    }
    
    .status-item:last-child {
        border-bottom: none;
    }
    
    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 1rem;
        flex-shrink: 0;
    }
    
    .status-content {
        flex: 1;
    }
    
    .status-title {
        font-weight: 500;
        margin-bottom: 0.25rem;
    }
    
    .status-desc {
        font-size: 0.9rem;
        color: #666;
    }
    
    .quick-action-card {
        background: white;
        border-radius: 1rem;
        padding: 2rem;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    
    .quick-action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    
    .quick-action-card .icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    
    .quick-action-card h5 {
        margin-bottom: 1rem;
        color: #333;
    }
    
    .quick-action-card p {
        color: #666;
        margin-bottom: 1.5rem;
        flex-grow: 1;
    }
    
    .code-block {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 0.5rem;
        margin: 1rem 0;
    }
    
    .code-block pre {
        margin: 0;
        padding: 1rem;
        background: none;
        border: none;
    }
    
    .api-key-section, .security-section {
        padding: 1rem 0;
    }
    
    .deploy-guide .step-by-step {
        margin: 2rem 0;
    }
    
    .deploy-step {
        display: flex;
        margin-bottom: 2rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid #eee;
    }
    
    .deploy-step:last-child {
        border-bottom: none;
    }
    
    .step-number {
        flex-shrink: 0;
        width: 40px;
        height: 40px;
        background: linear-gradient(45deg, #007bff, #28a745);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 1.5rem;
        margin-top: 0.5rem;
    }
    
    .step-content {
        flex: 1;
    }
    
    .step-content h6 {
        margin-bottom: 1rem;
        color: #333;
    }
    
    @keyframes checkmark {
        0% { transform: scale(0); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    
    .checklist-item.completed i {
        animation: checkmark 0.5s ease-out;
    }
    
    @media (max-width: 768px) {
        .quick-action-card {
            margin-bottom: 1rem;
        }
        
        .deploy-step {
            flex-direction: column;
        }
        
        .step-number {
            align-self: flex-start;
            margin-bottom: 1rem;
        }
    }
</style>
{% endblock %}

{% block extra_scripts %}
<script>
    // ç¾åœ¨ã®è¨­å®šçŠ¶æ…‹
    let currentProgress = 60; // åˆæœŸå®Œäº†ç‡
    let completedSteps = ['step1', 'step2'];
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
        checkApiStatus();
        updateProgress();
        
        // è¨­å®šãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡å‡¦ç†
        document.getElementById('settingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveSettings();
        });
    });
    
    // APIçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
    async function checkApiStatus() {
        try {
            const response = await fetch('http://localhost:8000/health/');
            const statusElement = document.getElementById('apiStatus');
            
            if (response.ok) {
                statusElement.textContent = 'æ­£å¸¸ç¨¼åƒä¸­';
                statusElement.parentElement.previousElementSibling.className = 'status-indicator status-healthy';
            } else {
                statusElement.textContent = 'æ¥ç¶šã‚¨ãƒ©ãƒ¼';
                statusElement.parentElement.previousElementSibling.className = 'status-indicator status-error';
            }
        } catch (error) {
            const statusElement = document.getElementById('apiStatus');
            statusElement.textContent = 'ã‚µãƒ¼ãƒãƒ¼æœªèµ·å‹•';
            statusElement.parentElement.previousElementSibling.className = 'status-indicator status-error';
        }
    }
    
    // é€²æ—æ›´æ–°
    function updateProgress() {
        const progressBar = document.getElementById('overallProgress');
        const progressText = document.getElementById('progressText');
        
        progressBar.style.width = currentProgress + '%';
        progressText.textContent = currentProgress + '%';
        
        // å®Œäº†ã‚¹ãƒ†ãƒƒãƒ—ã®UIæ›´æ–°
        completedSteps.forEach(stepId => {
            const step = document.getElementById(stepId);
            if (step && !step.classList.contains('completed')) {
                step.classList.remove('pending');
                step.classList.add('completed');
                
                const icon = step.querySelector('i');
                icon.className = 'bi bi-check-circle-fill text-success';
            }
        });
    }
    
    // ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†ãƒãƒ¼ã‚¯
    function markStepCompleted(stepId) {
        if (!completedSteps.includes(stepId)) {
            completedSteps.push(stepId);
            currentProgress = Math.min(100, currentProgress + 20);
            updateProgress();
            showAlert('è¨­å®šã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼', 'success', 3000);
        }
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹
        const modals = ['apiKeyModal', 'securityModal', 'deployModal'];
        modals.forEach(modalId => {
            const modal = bootstrap.Modal.getInstance(document.getElementById(modalId));
            if (modal) modal.hide();
        });
    }
    
    // APIã‚­ãƒ¼ã‚¬ã‚¤ãƒ‰è¡¨ç¤º
    function showApiKeyGuide() {
        const modal = new bootstrap.Modal(document.getElementById('apiKeyModal'));
        modal.show();
    }
    
    // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰è¡¨ç¤º
    function showSecurityGuide() {
        const modal = new bootstrap.Modal(document.getElementById('securityModal'));
        modal.show();
    }
    
    // ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰è¡¨ç¤º
    function showDeployGuide() {
        const modal = new bootstrap.Modal(document.getElementById('deployModal'));
        modal.show();
    }
    
    // è©³ç´°ã‚¬ã‚¤ãƒ‰è¡¨ç¤º
    function showDetailedGuide() {
        const guideContent = `
EmotionMemCore è©³ç´°è¨­å®šã‚¬ã‚¤ãƒ‰

ğŸ“š ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰:

1. åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   - Python 3.11+ ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
   - Poetry ã¾ãŸã¯ pip ã§ã®ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   - åŸºæœ¬å‹•ä½œç¢ºèª

2. é–‹ç™ºç’°å¢ƒã§ã®åˆ©ç”¨
   - ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹ã§ APIã‚­ãƒ¼ä¸è¦
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®å‹•ä½œç¢ºèª
   - ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ã®æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

3. æœ¬æ ¼é‹ç”¨ã¸ã®ç§»è¡Œ
   - OpenAI APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®š
   - Claude APIã‚­ãƒ¼å–å¾—ãƒ»è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
   - ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ç„¡åŠ¹åŒ–

4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–
   - èªè¨¼æ©Ÿèƒ½æœ‰åŠ¹åŒ–
   - ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨­å®š
   - CORSè¨­å®š

5. æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
   - Dockerç’°å¢ƒæ§‹ç¯‰
   - HTTPSè¨­å®š
   - ç›£è¦–ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š

è©³ç´°ã¯ README.md ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
        `;
        
        alert(guideContent);
    }
    
    // ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¡¨ç¤º
    function showTroubleshooting() {
        const troubleContent = `
ğŸ”§ ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

âŒ "Connection Error" ãŒè¡¨ç¤ºã•ã‚Œã‚‹
â†’ ãƒ¡ã‚¤ãƒ³APIã‚µãƒ¼ãƒãƒ¼ (port 8000) ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
â†’ python main.py ã§APIã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•

âŒ APIã‚­ãƒ¼ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹
â†’ .env ãƒ•ã‚¡ã‚¤ãƒ«ã® APIã‚­ãƒ¼è¨­å®šã‚’ç¢ºèª
â†’ é–‹ç™ºæ™‚ã¯ LLM_MOCK_MODE=true ã§ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ä½¿ç”¨

âŒ ãƒãƒ¼ãƒˆãŒä½¿ç”¨ä¸­ã‚¨ãƒ©ãƒ¼
â†’ lsof -i :8000 ã§ãƒãƒ¼ãƒˆä½¿ç”¨çŠ¶æ³ç¢ºèª
â†’ æ—¢å­˜ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¦ã‹ã‚‰å†èµ·å‹•

âŒ Dockerèµ·å‹•ã‚¨ãƒ©ãƒ¼
â†’ docker-compose down ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
â†’ docker-compose build --no-cache ã§å†ãƒ“ãƒ«ãƒ‰

âŒ è¨˜æ†¶ä¿å­˜ãƒ»æ¤œç´¢ãŒã§ããªã„
â†’ ChromaDB ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ç¢ºèª
â†’ DEBUG_MODE=true ã§è©³ç´°ãƒ­ã‚°ç¢ºèª

ãã®ä»–ã®å•é¡Œã¯ GitHub Issues ã«ã”å ±å‘Šãã ã•ã„ã€‚
        `;
        
        alert(troubleContent);
    }
    
    // è¨­å®šä¿å­˜
    async function saveSettings() {
        const formData = new FormData(document.getElementById('settingsForm'));
        const settings = Object.fromEntries(formData);
        
        try {
            // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€è¨­å®šä¿å­˜ API ã‚’å‘¼ã³å‡ºã—
            // const response = await fetch('/api/settings', {
            //     method: 'POST',
            //     body: JSON.stringify(settings),
            //     headers: { 'Content-Type': 'application/json' }
            // });
            
            // ãƒ‡ãƒ¢ç”¨ã®ç–‘ä¼¼ä¿å­˜
            setTimeout(() => {
                showAlert('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•å¾Œã«æœ‰åŠ¹ã«ãªã‚Šã¾ã™ã€‚', 'success', 5000);
                
                // UIæ›´æ–°
                updateSettingsDisplay(settings);
            }, 1000);
            
        } catch (error) {
            showAlert('è¨­å®šä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'danger');
        }
    }
    
    // è¨­å®šè¡¨ç¤ºæ›´æ–°
    function updateSettingsDisplay(settings) {
        // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€è¨­å®šå€¤ã«å¿œã˜ã¦ãƒãƒƒã‚¸ã®è‰²ã‚„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°
        showAlert('è¨­å®šè¡¨ç¤ºã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'info', 2000);
    }
    
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã«ãƒªã‚»ãƒƒãƒˆ
    function resetToDefaults() {
        if (confirm('è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ')) {
            document.getElementById('environmentSelect').value = 'development';
            document.getElementById('debugModeSelect').value = 'true';
            document.getElementById('mockModeSelect').value = 'true';
            document.getElementById('authSelect').value = 'false';
            document.getElementById('rateLimitSelect').value = 'false';
            document.getElementById('logLevelSelect').value = 'INFO';
            
            showAlert('è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ', 'info', 3000);
        }
    }
    
    // è¨­å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    function exportSettings() {
        const formData = new FormData(document.getElementById('settingsForm'));
        const settings = Object.fromEntries(formData);
        
        const exportData = {
            export_date: new Date().toISOString(),
            emotionmemcore_version: '0.1.0',
            settings: settings
        };
        
        const dataStr = JSON.stringify(exportData, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        
        const url = URL.createObjectURL(dataBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `emotionmemcore_settings_${new Date().toISOString().slice(0, 10)}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showAlert('è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success', 3000);
    }
    
    // ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºï¼ˆå†åˆ©ç”¨å¯èƒ½ãªå…±é€šé–¢æ•°ï¼‰
    function showAlert(message, type = 'info', duration = 5000) {
        // Bootstrap alert ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã®å®Ÿè£…
        // ç°¡æ˜“ç‰ˆã¨ã—ã¦ alert ã‚’ä½¿ç”¨
        if (type === 'danger' || type === 'error') {
            console.error(message);
        } else {
            console.log(message);
        }
        
        // ã‚ˆã‚Šè‰¯ã„UXã®ãŸã‚ã«ã¯ã€å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§toasté€šçŸ¥ã‚’å®Ÿè£…
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
        alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
        `;
        
        document.body.appendChild(alertDiv);
        
        // è‡ªå‹•æ¶ˆå»
        if (duration > 0) {
            setTimeout(() => {
                if (alertDiv.parentElement) {
                    alertDiv.remove();
                }
            }, duration);
        }
    }
</script>
{% endblock %}